/* 0. 색상 변수 정의 (일관된 관리를 위해 도입) */
:root {
    --bg-color: #0f172a;       /* 아주 깊은 네이비 (배경) */
    --card-bg: #1e293b;       /* 카드 및 입력창 배경 */
    --primary: #38bdf8;       /* 데이터 강조 (스카이 블루) */
    --secondary: #818cf8;     /* 시스템 지표 (퍼플 블루) */
    --accent: #f87171;        /* 경고/에러 (소프트 레드) */
    --text-main: #f1f5f9;     /* 메인 글자색 */
    --text-muted: #94a3b8;    /* 보조 설명색 */
    --border-color: #334155;  /* 경계선 색상 */
}

/* 1. 기본 배경 및 레이아웃 */
body {
    background-color: var(--bg-color) !important;
    color: var(--text-main) !important;
    font-family: 'Pretendard', -apple-system, sans-serif;
    margin: 0; padding: 0;
    display: flex; 
    flex-direction: column; 
    align-items: center;
    line-height: 1.6;
}

.container {
    width: 100%;
    max-width: 343px;
    padding: 40px 0;
    box-sizing: border-box;
}

/* 2. 상단 고정 진행 바 */
.progress-container {
    width: 100%;
    background: var(--border-color);
    height: 4px;
    position: fixed;
    top: 0; left: 0;
    z-index: 1000;
}
.progress-bar {
    height: 100%;
    background: var(--primary); /* 스카이 블루로 변경 */
    width: 0%;
    transition: width 0.3s ease;
}

/* 3. 단계별 섹션 제어 */
.step { display: none; width: 100%; flex-direction: column; }
.step.active { display: flex; animation: fadeIn 0.4s ease; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

/* 4. 텍스트 및 레이블 간격 */
.title { font-size: 24px; font-weight: 700; margin-bottom: 24px; line-height: 1.3; color: var(--text-main); }
.label { font-size: 14px; font-weight: 600; margin-bottom: 8px; margin-top: 24px; display: block; color: var(--primary); }
.description { color: var(--text-muted); font-size: 14px; margin-bottom: 12px; margin-top: -4px; }
.pi-info { color: var(--text-muted); font-size: 13px; margin-top: 16px; border-top: 1px solid var(--border-color); padding-top: 12px; }

/* 5. 입력창 (성명, 만 나이, PIN) */
.input-group { margin-bottom: 16px; }
.input-group.last { margin-bottom: 24px; }

input[type="number"], input[type="text"], #userPin {
    width: 100% !important;
    height: 52px;
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    color: var(--text-main);
    padding: 0 16px;
    box-sizing: border-box;
    font-size: 16px;
    outline: none;
    margin-top: 8px;
    transition: border-color 0.2s;
}

input:focus, #userPin:focus {
    border-color: var(--primary); /* 포커스 시 스카이 블루 */
}

/* 6. 버튼 스타일 */
.next-btn, #goSurveyBtn, #goReportBtn, .btn-solid-white {
    width: 100%;
    height: 52px;
    background-color: var(--text-main) !important; /* 이미지의 화이트 버튼 유지 */
    color: #000000 !important;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    margin-top: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
}

.next-btn:hover { background-color: #cbd5e1 !important; }
.next-btn:disabled { background-color: var(--border-color) !important; color: var(--text-muted) !important; }

.secondary-btn, .btn-outline-gray {
    background-color: transparent !important;
    color: var(--text-main) !important;
    border: 1px solid var(--border-color) !important;
    transition: all 0.3s ease;
}

/* 7. 성별 및 칩 선택 */
.gender-label, .chip {
    display: flex; align-items: center; justify-content: center;
    height: 52px; background: var(--card-bg); border: 1px solid var(--border-color);
    border-radius: 8px; cursor: pointer; font-weight: 500; transition: 0.2s;
    color: var(--text-main);
}
.gender-item input[type="radio"]:checked + .gender-label {
    background: var(--primary); color: #000; border-color: var(--primary);
}
.chip.selected {
    background: var(--border-color); border: 1px solid var(--primary); color: var(--primary);
}

/* 8. 아코디언 및 동의 항목 */
.consent-item { background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 8px; margin-bottom: 16px; overflow: hidden; }
.subject { font-size: 15px; font-weight: 500; color: var(--text-main); }
.badge { background: var(--secondary); color: #000; padding: 2px 6px; border-radius: 4px; font-size: 11px; font-weight: bold; }
.badge.select-badge { background: var(--border-color); color: var(--text-muted); }
.consent-content { background: #0b1222; } /* 본문보다 살짝 더 어두운 배경 */
.consent-text-area { color: var(--text-muted); }
.consent-text-area::-webkit-scrollbar-thumb { background: var(--secondary); }

/* 체크박스 */
input[type="checkbox"] {
    appearance: none; -webkit-appearance: none;
    width: 22px; height: 22px; border: 2px solid var(--border-color); border-radius: 4px;
    background-color: var(--card-bg); cursor: pointer; position: relative;
}
input[type="checkbox"]:checked { background-color: var(--primary); border-color: var(--primary); }
input[type="checkbox"]:checked::after { content: '✔'; color: #000; position: absolute; left: 4px; top: -2px; font-size: 16px; font-weight: bold; }

/* 9. 설문 문항 스타일 */
.step-indicator { font-size: 18px; font-weight: 400; color: var(--primary); text-align: center; margin-top: 20px; }
.ans-btn {
    width: 100%; height: 52px; background: var(--card-bg); border: 1px solid var(--border-color);
    border-radius: 8px; color: var(--text-main); font-size: 16px; text-align: left; padding: 0 20px; cursor: pointer;
}
.ans-btn.selected { background-color: var(--primary); color: #000; border-color: var(--primary); }

/* 10. qEEG 업로드 박스 */
.qeeg-box { background: var(--card-bg); border: 1px solid var(--border-color); }
.qeeg-status.status-active { color: var(--primary) !important; font-weight: bold; }
.file-btn { background: var(--border-color) !important; color: var(--text-main) !important; }

/* 11. 모달 스타일 */
.modal-overlay { background: rgba(15, 23, 42, 0.9); }
.modal-content { background: var(--card-bg); border: 1px solid var(--primary); }
#modalOkBtn { background-color: var(--primary) !important; color: #000 !important; }
#modalOkBtn:hover { background-color: var(--secondary) !important; }

/* 12. 음성 녹음 (Voice) */
#timer { color: var(--primary); }
#recordIcon { background: var(--accent); } /* 중지/녹음 버튼은 accent 레드 활용 */

/* 13. 분석 리포트 카드 및 테이블 */
.card { background: var(--card-bg) !important; border: 1px solid var(--border-color) !important; }
.card-title { color: var(--primary); }
th { background-color: #1e293b; color: var(--secondary); border-bottom: 1px solid var(--border-color); }
td { color: var(--text-main); border-bottom: 1px solid var(--border-color); }
.val-col { color: var(--primary); }

/* 리포트 뱃지 상태색 */
.badge.good { background: rgba(56, 189, 248, 0.2); color: var(--primary); }
.badge.warn { background: rgba(248, 113, 113, 0.2); color: var(--accent); }

/* CASP 관련 추가 섹션 */
.research-info-card-minimal { background: var(--card-bg); }
.protocol-main-title { color: var(--text-main); }
.version-dimmed-sub { color: var(--text-muted); }
.en-sub-text { color: var(--text-muted); }

/* AB 질문 박스 */
.ab-badge { background: rgba(129, 140, 248, 0.2); color: var(--secondary); }
.ab-box { border: 1px solid var(--border-color); background: rgba(255,255,255,0.02); }